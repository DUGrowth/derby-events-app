name: Trigger Event Sync

on:
  schedule:
    - cron: "0 */6 * * *"
  workflow_dispatch:

jobs:
  trigger:
    runs-on: ubuntu-latest
    steps:
      - name: Trigger sync endpoint
        env:
          SYNC_TRIGGER_URL: ${{ secrets.SYNC_TRIGGER_URL }}
          ADMIN_SYNC_TOKEN: ${{ secrets.ADMIN_SYNC_TOKEN }}
        run: |
          if [ -z "$SYNC_TRIGGER_URL" ]; then
            echo "SYNC_TRIGGER_URL secret is missing" >&2
            exit 1
          fi
          curl -fsSL -H "x-admin-token: ${ADMIN_SYNC_TOKEN}" "$SYNC_TRIGGER_URL"
